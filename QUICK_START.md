# ðŸš€ Quick Start: Deploy OpenCode to the Cloud (5 minutes)

## Option 1: Railway (Recommended - Easiest)

### Step 1: Create Free Railway Account
1. Go to https://railway.app
2. Sign up with GitHub
3. Create new project

### Step 2: Connect GitHub Repository
```bash
# In Railway dashboard:
# 1. Click "New Project"
# 2. Select "Deploy from GitHub"
# 3. Authorize and select your opencode repository
```

### Step 3: Add Services
```bash
# Railway will auto-detect from railway.json
# Services auto-created:
# - Backend API (from Dockerfile.prod)
# - PostgreSQL Database (from railway.json)
# - Frontend (optional)
```

### Step 4: Configure Environment
```bash
# In Railway Dashboard â†’ Variables:
DATABASE_URL=<auto-generated by Railway>
NODE_ENV=production
API_KEY=<generate-random-secret>
CORS_ORIGIN=https://your-domain.com
LLM_API_KEY=<your-openai-key>
```

### Step 5: Deploy
```bash
# Just push to GitHub
git add .
git commit -m "Deploy to Railway"
git push

# Railway auto-deploys on push!
```

**Result**:
- âœ… Backend running at: `https://your-project.up.railway.app`
- âœ… Database connected automatically
- âœ… Custom domain support
- âœ… Auto-HTTPS/SSL

---

## Option 2: Docker Compose (Local Testing First)

### Step 1: Start Local Environment
```bash
# Copy environment template
cp .env.example .env

# Start all services (DB, API, Frontend)
docker-compose up -d

# Check status
docker-compose ps
```

### Step 2: Verify Services
```bash
# API Health Check
curl http://localhost:3000/health

# Frontend
open http://localhost:3001

# Database (if needed)
psql postgres://opencode:opencode@localhost:5432/opencode_prod
```

### Step 3: View Logs
```bash
docker-compose logs -f api
docker-compose logs -f db
```

### Step 4: Stop Services
```bash
docker-compose down
```

---

## Option 3: Vercel + Railway (Recommended Setup)

### Frontend: Deploy to Vercel
```bash
# 1. Go to vercel.com
# 2. Connect GitHub
# 3. Select packages/app
# 4. Add environment variable:
VITE_API_URL=https://your-railway-api.up.railway.app

# Deploy!
```

### Backend: Deploy to Railway
```bash
# Follow Option 1 (Railway) above
```

**Result**:
- âœ… Lightning-fast CDN frontend (Vercel)
- âœ… Scalable backend API (Railway)
- âœ… PostgreSQL Database (Railway)
- âœ… Separate domain for each service

---

## Configuration Checklist

Before deploying to production:

```
ENVIRONMENT SETUP
- [ ] .env file created and configured
- [ ] API_KEY set to random secret
- [ ] DATABASE_URL correctly set
- [ ] CORS_ORIGIN matches your domain
- [ ] LLM API keys added if using AI features

SECURITY
- [ ] No secrets in code/git
- [ ] API authentication enabled
- [ ] HTTPS/TLS configured
- [ ] CORS properly restricted

MONITORING
- [ ] Health check endpoint working
- [ ] Error logging configured
- [ ] Database backups enabled
- [ ] Rate limiting enabled

PERFORMANCE
- [ ] Frontend minified
- [ ] Database indexes created
- [ ] CDN configured for static files
- [ ] Connection pooling enabled
```

---

## Troubleshooting

### "Database connection failed"
```bash
# Check DATABASE_URL format
postgresql://user:password@host:port/database

# Verify database is running
docker-compose logs db
```

### "CORS errors in frontend"
```bash
# Add frontend URL to CORS_ORIGIN
CORS_ORIGIN=https://frontend-domain.com

# Restart API
docker-compose restart api
```

### "API returning 500 errors"
```bash
# Check logs
docker-compose logs api

# Check environment variables
docker-compose config | grep DATABASE_URL
```

### "Out of memory"
```bash
# Increase Railway memory allocation
# Dashboard â†’ Settings â†’ Memory: 2GB+ recommended
```

---

## Monitoring & Updates

### View Logs
```bash
# Railway Dashboard
# â†’ Logs tab â†’ View real-time logs

# Docker
docker-compose logs -f --tail=100 api
```

### Update Deployment
```bash
# Just push to GitHub - Railway auto-redeploys!
git push

# Or manually trigger in Railway dashboard
```

### Database Migrations
```bash
# Run before deploying schema changes
bun run db:migrate

# Rollback if needed
bun run db:rollback
```

---

## Cost Estimate (Monthly)

| Service | Railway | Vercel | Other |
|---------|---------|--------|-------|
| Backend | $7 | - | varies |
| Database | $15 | - | $15-50 |
| Frontend | - | FREE | $5-20 |
| CDN | included | FREE | $5+ |
| **Total** | **$22** | **FREE** | **$25-70** |

Railway's generous free tier includes:
- 500 hours of compute/month
- 5GB PostgreSQL
- Great for small projects!

---

## Next Steps

1. **Choose deployment platform** (Railway recommended)
2. **Set up .env** with your config
3. **Test locally** with docker-compose
4. **Deploy to cloud**
5. **Configure custom domain**
6. **Set up monitoring**
7. **Enable backups**

**Questions?** Check DEPLOYMENT.md for detailed docs
